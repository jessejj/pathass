<!DOCTYPE html>
<head>
    <title>Pathology Assistant</title>
 
	<HTA:APPLICATION
		APPLICATIONNAME = "Jesse's first HTA HTML Application"
		ID = "PathologyAssistantApp"
        VERSION="708e63e10e1c7bb86e8a49872d65dcbe3cd4502d"
        SINGLEINSTANCE = "Yes"
        SCROLL="no"
        BORDER="thin"
        INNERBORDER="no"
        MAXIMIZEBUTTON="no"
        
    />

</head>

<script language="VBScript">
    Sub Window_onLoad
        window.resizeTo 800,700
    End Sub

    Sub CheckSHA

        Dim o
        Set o = CreateObject("MSXML2.XMLHTTP")
        o.open "GET", "https://api.github.com/repos/jessepelley/pathologyAssistant/tags", False
        o.send

        jsontext = "{" & Chr(34) & "name" & Chr(34) & ":" & chr(34) '{"name":"

        If o.Status = 200 Then

        json = o.responseText

        If InStr(json, PathologyAssistantApp.Version) = 0 then UpdateText = "Unsupported" Else UpdateText = "Supported"

        End If

        document.getElementById("Back").disabled = False
        document.getElementById("header").innerHTML = "Checking for update"
        document.getElementById("1").innerHTML = "Status: " & o.Status
        document.getElementById("4").innerHTML = UpdateText
        document.getElementById("5").innerHTML = "<a href='https://github.com/jessepelley/pathologyAssistant/releases'> Download </a>"
        Set o = Nothing

    End Sub

</script>

<body style="font-family:'Segoe UI', Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif; margin: 30px" >

<div id="home">
<h1 style="text-align:center" id="header">This App includes code to check for updates</h1>
<p id="1"><button type="button" onclick="CheckSHA">Check</button> Check for Updates</p>
<p id="2"></p>
<p id="3"> </p>
<p id="4"> </p>
<p id="5"> </p>
<p id="6"> </p>
<p id="7"> </p>
<p id="8"> </p>
<p id="9"> </p>
<p id="10"> </p>
<p id="11"> </p>
<p id="12"> </p>
<p id="13"> </p>
<p id="14"> </p>
<p id="15"></p>
</div>
<input type=button value="Back" id="Back" onClick="window.location.reload()" disabled>

</body>
 
</html>
