<!DOCTYPE html>

<div id="container">
<div id="header">
<head>
    <title>Pathology Assistant</title>
 
	<HTA:APPLICATION
		ID = "PA"
        VERSION="ca8347f50a5a5b4ad804fd817702d5dc38fe0211"
        SINGLEINSTANCE = "Yes"
        SCROLL="no"
        BORDER="thin"
        INNERBORDER="no"
        MAXIMIZEBUTTON="no"
        
    />
<style>

</style>
</head>
</div>

<script lang="javascript">

	window.onload = (function main(){
		window.resizeTo(700, 950);
		ClearIDs();
		document.getElementById("footer").innerHTML = "Checking for updates";

		o = new XMLHttpRequest();
		o.open("GET", "https://api.github.com/repos/jessepelley/pathologyAssistant/tags", false);
		o.send();

		if (o.status == 200) {
			json = o.responseText;
		}

		document.getElementById("title").innerHTML = "Pathology Assistant App";

		if (json.indexOf(PA.version) == -1) {
			UpdateText = "<input type='button' onclick='openLink()' value='Update'><br><i>Unsupported Version</i>";
			Supported = false;
		} else {
			UpdateText = "Supported Version";
			Supported = true;
		}

		document.getElementById("footer").innerHTML = UpdateText;

		if (Supported) {
			for (i = 1; i < 11; i++){
			document.getElementById(i).disabled = false;
			}

			document.getElementById(1).innerHTML = '<button class="button" type="button" onclick="PowerPathSetup()">PowerPath Setup</button>';
			document.getElementById(2).innerHTML = '<button class="button" type="button" onclick="Cassettes()">Cassettes</button>';
			document.getElementById(3).innerHTML = '<button class="button" type="button" onclick="Commands()">Commands</button>';
		}
		document.getElementById(10).innerHTML = '<button class="button" type="button" onclick="Help()">Help</button>';
	})

	function Help() {
		helpURL = "https://outlook.office.com/mail/deeplink/compose?to=jpelley@eorla.ca&subject=Pathology%20Assistant%20App&body=%0A%0A%0A%0A%0A%0A%0A%0A%0A%0AApp%20Version%20";
		var shell = new ActiveXObject("wscript.shell");
		shell.run(helpURL + PA.version);
	}		
	
	function Commands() {
		ClearIDs();
		document.getElementById("Back").disabled = false;
		document.getElementById("title").innerHTML = "Commands";
		document.getElementById("1").innerHTML = '<button class="button" type="button" onclick="" disabled>Delete block</button>';
		document.getElementById("2").innerHTML = '<button class="button" type="button" onclick="" disabled>Duplicate block</button>';
		document.getElementById("3").innerHTML = '<button class="button" type="button" onclick="" disabled>Next block</button>';
		document.getElementById("4").innerHTML = '<button class="button" type="button" onclick="" disabled>My Signature</button>';


	}	
	
	function PowerPathSetup() {
		ClearIDs();
		PowerPathDBHTML = '<input onchange=EnableApplyButton() type="checkbox" id="PowerPathDB" name="PowerPathDB" value="PowerPathDB"><label for="PowerPathDB"> Database set to CLPATHDB01</label><br>';


		document.getElementById("Back").disabled = false;
		document.getElementById("title").innerHTML = "PowerPath Setup";
		document.getElementById("1").innerHTML = PowerPathDBHTML;
		//document.getElementById("2").innerHTML = BinHTML;

		//document.getElementById("PowerPathDB").checked = true;
	}


	function Cassettes(){
		if (Supported){
			ClearIDs();
			CASoptionsHTML = "<option value = ''></option><option value = 'CIV-GRO-CAS1'>CIV-GRO-CAS1</option>";
			PowerPathCassettesHTML = "PowerPath Auto Print: <select onchange=EnableApplyButton() name = 'CAS' id = 'CAS'>" + CASoptionsHTML + "</select>";
			BinHTML = "Exit bin: <select onchange=EnableApplyButton() name = 'ExitBin' id = 'ExitBin'> <option value = 'ExitBin1' selected>Bin 1</option><option value = 'ExitBin2'>Bin 2</option><option value = 'ExitBin3'>Bin 3</option></select>";

			document.getElementById("Back").disabled = false;
			document.getElementById("title").innerHTML = "Cassettes";
			document.getElementById("1").innerHTML = PowerPathCassettesHTML;
			document.getElementById("2").innerHTML = BinHTML;

			document.getElementById("Apply").onclick = function() {ApplyCassettes()}
		}
	}

	function EnableApplyButton(){
		document.getElementById("Apply").disabled = false;
	}

	function ApplyCassettes(){
		selectedExitBin = document.getElementById("ExitBin").value;
		if (selectedExitBin == "ExitBin2" || selectedExitBin == "ExitBin3") {
			shell = new ActiveXObject("wscript.shell");
			shell.run ("%comspec% /K title Cassette Script | cscript.exe /nologo Resources/TriageCassettesScript.vbs " + document.getElementById("ExitBin").value);
		}
	}

	function TriageCassettes(){
		if (Supported) {
			var shell = new ActiveXObject("wscript.shell");
			shell.run ("%comspec% /K title Cassette Script | cscript.exe /nologo Resources/TriageCassettesScript.vbs " + document.getElementById("ExitBin").value);		}
	}

	function ClearIDs(){
		for (i = 1; i < 11; i++){
			document.getElementById(i).innerHTML = "&nbsp;";
		}
	}

	function openLink(){
		var shell = new ActiveXObject("wscript.shell");
		shell.run("https://github.com/jessepelley/pathologyAssistant/releases");
	}

	

</script>

<div id="body">
<body style="font-family:'Segoe UI', Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif; margin: 30px" >

<div id="home">
<h1 style="text-align:center" id="title">IF YOU ARE READING THIS YOU DID NOT EXTRACT THE ARCHIVE. PLEASE CLOSE AND EXTRACT AND UNCHECK 'ALWAYS CHECK'</h1>
<p id="1"></p>
<p id="2"></p>
<p id="3"></p>
<p id="4"></p>
<p id="5"></p>
<p id="6"></p>
<p id="7"></p>
<p id="8"></p>
<p id="9"></p>
<p id="10"></p>
</div>
<input class="button" type=button value="Back" id="Back" onClick="window.location.reload()" disabled> <input class="button" type=button value="Apply" id="Apply" onClick="" disabled><br><br>
</body>
</div>
<div id="footer"></div>
</div>
</html>
