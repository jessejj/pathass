<!DOCTYPE html>
<head>
    <title>Pathology Assistant</title>
 
	<HTA:APPLICATION
		ID = "PA"
        VERSION="64dd270bedf664994d14f073f2898be95342b2f7"
        SINGLEINSTANCE = "Yes"
        SCROLL="no"
        BORDER="thin"
        INNERBORDER="no"
        MAXIMIZEBUTTON="no"
        
    />

</head>

<script language="VBScript">
    Sub Window_onLoad
        window.resizeTo 800,700
    End Sub

    Sub CheckSHA

        Dim o
        Set o = CreateObject("MSXML2.XMLHTTP")
        o.open "GET", "https://api.github.com/repos/jessepelley/pathologyAssistant/tags", False
        o.send

        If o.Status = 200 Then

        json = o.responseText

        End If

        If InStr(json, PA.Version) = 0 then UpdateText = "Unsupported" Else UpdateText = "Supported"


        document.getElementById("Back").disabled = False
        document.getElementById("header").innerHTML = "Checking for update"
        document.getElementById("1").innerHTML = UpdateText
        document.getElementById("2").innerHTML = "<input type='button' onclick='openLink()' value='Download'>"
        Set o = Nothing

    End Sub

    Sub openLink

        Set shell = CreateObject("WScript.Shell")
        shell.run "https://github.com/jessepelley/pathologyAssistant/releases"

    End Sub

</script>

<body style="font-family:'Segoe UI', Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif; margin: 30px" >

<div id="home">
<h1 style="text-align:center" id="header">This App includes code to check for updates</h1>
<p id="1"><button type="button" onclick="CheckSHA">Check</button> Check for Updates</p>
<p id="2"></p>
<p id="3"> </p>
<p id="4"> </p>
<p id="5"> </p>
<p id="6"> </p>
<p id="7"> </p>
<p id="8"> </p>
<p id="9"> </p>
<p id="10"> </p>
<p id="11"> </p>
<p id="12"> </p>
<p id="13"> </p>
<p id="14"> </p>
<p id="15"></p>
</div>
<input type=button value="Back" id="Back" onClick="window.location.reload()" disabled>

</body>
 
</html>
